<div
  class="single-registration"
  *ngIf="{
    labSampleLabel: labSampleLabel$ | async,
    testsUnderDepartment: testsUnderDepartment$ | async
  } as params"
>
  <div class="row" *ngIf="params?.labSampleLabel">
    <div class="col-12" *ngIf="savingData">
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </div>

    <div class="col-lg-4 col-md-4 col-sx-12 col-sm-12 mt-2">
      <fieldset>
        <legend>Patient Details</legend>
        <app-person-details
          [referFromFacilityVisitAttribute]="referFromFacilityVisitAttribute"
          (personDetails)="onGetPersonDetails($event)"
        ></app-person-details>
      </fieldset>
    </div>
    <div class="col-lg-4 col-md-4 col-sx-12 col-sm-12 mt-2">
      <div class="for-sample-label">
        <fieldset>
          <legend>Specimen Details</legend>
          <app-sample-label
            [label]="params?.labSampleLabel"
            (sampleLabel)="onGetSampleLabel($event)"
          ></app-sample-label>
          <app-form
            [fields]="specimenDetailsFields"
            (formUpdate)="onFormUpdate($event)"
          ></app-form>
        </fieldset>
      </div>
      <div class="tests">
        <fieldset>
          <legend>Tests</legend>
          <!-- <app-lb-option-selector
              *ngIf="params?.testsUnderDepartment"
              [options]="params?.testsUnderDepartment"
              [id]="'tests'"
              [label]="'Test'"
              (selectedOptionDetails)="onGetSelectedOptionDetails($event)"
            ></app-lb-option-selector> -->
          <app-form
            [fields]="[testsFormField]"
            (formUpdate)="onFormUpdateForTest($event)"
          ></app-form>
        </fieldset>
      </div>
    </div>
    <div class="col-lg-4 col-md-4 col-sx-12 col-sm-12 mt-2">
      <div class="clinical-data">
        <fieldset>
          <legend>Clinical Data</legend>
          <app-clinical-data
            (clinicalDataValues)="onGetClinicalDataValues($event)"
          ></app-clinical-data>
        </fieldset>
      </div>

      <div class="referring-doctor-field">
        <fieldset>
          <legend>Referring Doctor</legend>
          <app-form
            [isFormHorizontal]="true"
            [fields]="referringDoctorFields"
            (formUpdate)="onFormUpdate($event)"
          ></app-form>
        </fieldset>
      </div>
    </div>
    <div class="col-12" *ngIf="savingDataResponse?.error">
      <div *ngIf="savingDataResponse?.error?.error">
        <div
          class="alert alert-danger"
          *ngFor="
            let globalError of savingDataResponse?.error?.error?.globalErrors
          "
          role="alert"
        >
          {{ globalError?.message }}
        </div>
      </div>
      <div *ngIf="savingDataResponse?.fieldErrors?.activeAttributes">
        <div
          class="alert alert-danger"
          *ngFor="
            let activeAttribute of savingDataResponse?.fieldErrors
              ?.activeAttributes
          "
          role="alert"
        >
          {{ activeAttribute?.message }}
        </div>
      </div>
    </div>
    <div class="col-12 d-flex justify-content-end mt-2 mb-2">
      <button mat-stroked-button color="primary" (click)="onSave($event)">
        Save
      </button>
    </div>
  </div>

  <mat-progress-bar
    *ngIf="!params?.labSampleLabel"
    mode="indeterminate"
  ></mat-progress-bar>
</div>
