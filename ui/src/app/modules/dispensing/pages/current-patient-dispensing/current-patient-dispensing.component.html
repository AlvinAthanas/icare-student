<div
  style="padding: 0 10px"
  *ngIf="{
    response: response$ | async,
    currentPatient: currentPatient$ | async,
    patientVisit: patientVisit$ | async,
    currentLocation: currentLocation$ | async,
    currentVisitLoadedState: currentVisitLoadedState$ | async,
    currentVisitLoadingState: currentVisitLoadingState$ | async,
    generalMetadataConfigurations: generalMetadataConfigurations$ | async,
    genericPrescriptionOrderType: genericPrescriptionOrderType$ | async,
    genericPrescriptionEncounterType: genericPrescriptionEncounterType$ | async,
    useGenericPrescription: useGenericPrescription$ | async
  } as params"
>
  <button mat-button color="light" (click)="onBack($event)">
    <mat-icon class="mr-2">arrow_back</mat-icon>
    <mat-label>Back To list</mat-label>
  </button>

  <mat-progress-bar
    class="mt-4"
    *ngIf="
      loading || !params?.currentPatient || params?.currentVisitLoadingState
    "
    mode="indeterminate"
  ></mat-progress-bar>
  <div class="row mt-2">
    <div class="col-12">
      <app-new-patient-profile
        *ngIf="params?.currentPatient && params?.currentVisitLoadedState"
        [currentPatient]="params?.currentPatient"
      ></app-new-patient-profile>
    </div>

    <div
      class="alert alert-danger w-100 mt-2"
      role="alert"
      *ngIf="params?.generalMetadataConfigurations === ''"
    >
      Missing General iCare Metadata Configurations, Contact IT
    </div>

    <div
      class="col-12"
      *ngIf="
        params?.generalMetadataConfigurations &&
        params?.generalMetadataConfigurations !== ''
      "
    >
      <p
        class="text-left text-danger"
        *ngIf="params?.response && params?.response?.message"
      >
        {{ params?.response?.message }}
      </p>
      <div class="border" *ngIf="params?.currentVisitLoadedState && params?.useGenericPrescription !== 'true'">
        <app-patient-drug-order-list
        [visit]="params?.patientVisit"
        [loading]="loading"
        [loadingError]="loadingError"
        [actionOptions]="dispensingActionOptions"
        [currentLocation]="params.currentLocation"
        [currentPatient]="params?.currentPatient"
        [generalMetadataConfigurations]="
        params?.generalMetadataConfigurations
        "
        (orderSelectAction)="
        onSelectAction($event, params?.patientVisit, params.currentLocation)
        "
        ></app-patient-drug-order-list>
      </div>
      <div class="border" *ngIf="params?.currentVisitLoadedState && params?.useGenericPrescription === 'true'">
        <app-patient-generic-drug-order-list
          [visit]="params?.patientVisit"
          [loading]="loading"
          [loadingError]="loadingError"
          [actionOptions]="dispensingActionOptions"
          [currentLocation]="params.currentLocation"
          [currentPatient]="params?.currentPatient"
          [genericPrescriptionOrderType]="params?.genericPrescriptionOrderType"
          [genericPrescriptionEncounterType]="params?.genericPrescriptionEncounterType"
          [generalMetadataConfigurations]="
            params?.generalMetadataConfigurations
          "
          (orderSelectAction)="
            onSelectAction($event, params?.patientVisit, params.currentLocation)
          "
        ></app-patient-generic-drug-order-list>
      </div>
    </div>
  </div>
</div>
